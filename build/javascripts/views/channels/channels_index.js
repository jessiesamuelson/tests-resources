RailsApi.Views.ChannelView=Backbone.View.extend({tagName:"li",template:JST["templates/channel_index"],initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){var e=this.template(this.model.attributes);return this.$el.append(e),this},events:{"click .edit-channel":"showEditForm","click .delete-channel":"deleteChannel","click .save-channel":"updateChannel","click .cancel":"cancelUpdate","click .more span":"toggleDetails"},deleteChannel:function(){var e=this;openModal(".channels","Are you sure you want to delete this channel?"),_.extend($(".channels .modal .confirm"),Backbone.Events),$(".channels .modal .confirm").click(function(){closeModal(),e.model.url=baseUrl+"/channels/"+e.model.id,e.model.destroy({success:function(e,t){notify(t.msg,"success")}},{error:function(e,t){notify(t.msg,"error")}})})},showEditForm:function(e){e.preventDefault();var t=$(this.el).find(".name"),i=$(this.el).find(".src"),n=$(this.el).find(".href"),a=$(this.el).find(".category_array"),l=$(this.el).find(".desc"),s=$(this.el).find(".keywords"),r=$(this.el).find(".banner_img"),d=$(this.el).find(".mobile_banner"),c=$(this.el).find(".twitter_widget_id"),o=$(this.el).find(".curator_img"),h=$(this.el).find(".curator_name"),f=$(this.el).find(".curator_desc"),m=$(this.el).find(".curator_video"),u=$(this.el).find(".edit-channel"),v=$(this.el).find(".delete-channel"),p=[];p.push(t,i,n,a,l,s,r,d,c,h,o,f,m),_.each(p,function(e){$(e).replaceWith(function(){var e=$(this).find(".value").html(),t=$(this).find("label"),i=$(this).attr("class"),n=$('<input type="text">'),a=$("<div>");return n.addClass(i).val($.trim(e)),"name"===i&&(t=$("<label>").html("Name:")),a.append(t).append(n),a})}),u.html("Save").attr("class","save-channel"),v.html("Cancel").attr("class","cancel"),$(this.el).wrapInner($("<form>").addClass("edit-form")),this.showMore()},updateChannel:function(){var e=$(this.el).find(".name").val(),t=$(this.el).find(".src").val(),i=$(this.el).find(".href").val(),n=$(this.el).find(".category_array").val().toLowerCase().split(","),a=$(this.el).find(".desc").val(),l=$(this.el).find(".keywords").val(),s=$(this.el).find(".twitter_widget_id").val(),r=$(this.el).find(".mobile_banner").val(),d=$(this.el).find(".banner_img").val(),c=$(this.el).find(".curator_name").val(),o=$(this.el).find(".curator_img").val(),h=$(this.el).find(".curator_desc").val(),f=$(this.el).find(".curator_video").val(),m=$(this.el).find(".save-channel").attr("data");this.model.set({name:e,src:t,href:i,category_array:n,desc:a,keywords:l,mobile_banner:r,banner_img:d,twitter_widget_id:s,curator_name:c,curator_img:o,curator_desc:h,curator_video:f}),this.model.url=baseUrl+"/channels/"+m,this.model.save(null,{success:function(e){notify(e.attributes.msg,"success")}},{error:function(e){notify(e.attributes.msg,"error")}})},cancelUpdate:function(e){e.preventDefault(),this.$el.empty(),this.render()},toggleDetails:function(e){var t=$(e.target).attr("class");$(e.target).parent().parent().find("div."+t).toggleClass("active")},showMore:function(){this.$el.find("div.details").addClass("active"),this.$el.find("div.curator").addClass("active")}}),RailsApi.Views.ChannelListView=Backbone.View.extend({initialize:function(){this.listenTo(this.collection,"all",this.render)},render:function(){var e=this;this.$el.empty(),_.each(this.collection.models,function(t){var i=new RailsApi.Views.ChannelView({model:t});e.$el.append(i.render().el)})}});